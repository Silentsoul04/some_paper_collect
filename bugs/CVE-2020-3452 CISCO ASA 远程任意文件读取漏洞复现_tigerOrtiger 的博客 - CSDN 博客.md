> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [blog.csdn.net](https://blog.csdn.net/wuyou1995/article/details/107549562)

CVE-2020-3452 CISCO ASA 远程任意文件读取漏洞
----------------------------------

#### 0x01 前言

昨天深夜 4 点 cisco asa 爆出了 CVE-2020-3452 漏洞，此漏洞可以在未验证的情况下进行任意文件读取。  
然后今天早上各大漏洞平台中找各种 POC。  
但是都只有漏洞通告  
于是去推特上一看，已经有大佬把 poc 公布出来了。  
推特是个好东西 ：）  
LOL

#### 0x02 漏洞信息

根据 ciso 官方通报的信息来看，【入口: [官方信息](https://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-asaftd-ro-path-KJuQhB86)】

该漏洞是由于受影响的设备处理的 HTTP 请求中的 URL 缺乏正确的输入验证所致。攻击者可以通过将包含目录遍历字符序列的特制 HTTP 请求发送到受影响的设备来利用此漏洞。成功的利用可能使攻击者可以在目标设备上查看 Web 服务文件系统内的任意文件。

当受影响的设备配置了 WebVPN 或 AnyConnect 功能时，将启用 Web 服务文件系统。此漏洞不能用于获取对 ASA 或 FTD 系统文件或基础操作系统（OS）文件的访问。

FOFA 检索规则  
FOFA: “webVpn”

根据官网的披露的信息来看，影响的设备还挺多的。  
![](https://img-blog.csdnimg.cn/20200723223306473.png)

#### 0x03 漏洞复现

根据推特中看到的信息来看，漏洞复现其实挺简单的。 happy hacking

POC  
`https://<domain>/+CSCOT+/translation-table?type=mst&textdomain=/%2bCSCOE%2b/portal_inc.lua&default-language&lang=../`  
例如读取读取 "/+CSCOE+/portal_inc."lua” 文件。  
![](https://img-blog.csdnimg.cn/20200723224036147.png)  
首先在 fofa 中找了一些设备，发现 url 中带有 + CSCOE+ 的是可能存在漏洞的设备，如下图所示。  
![](https://img-blog.csdnimg.cn/20200723235752118.png)

我根据 poc 用 burpsuit 复现，没有复现成功，可能是有的不存在漏洞，于是想偷个懒，把手动复现的过程写成了 poc 脚本，并且批量验证。 然后验证了，发现一大片都由此漏洞， 手动复现的运气真差。QAQ。  
poc 运行如下图所示。  
![](https://img-blog.csdnimg.cn/20200723235914534.png)

#### 0x03 总结

从验证的结果来看，截止目前为止，有很多的设备存在此漏洞，可以在未授权的情况下，读取设备内的任意文件。但是另一方面，推特中有个人问道，这个漏洞能造成多大的危害？这是值得去思考的点。 目前只是披露漏洞，虽然说是可以获取设备的 cookies，以及其他的信息 。但是却不知道 cookies 或者更敏感的信息保存在哪个文件中。