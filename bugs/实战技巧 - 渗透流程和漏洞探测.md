> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/7BLp3qbQV1Gufsbe5TLzTw)

渗透流程和工具选择

1. 渗透目标
-------

2. 信息收集（收集源 IP、端口信息、操作系统版本、中间件、框架等）
-----------------------------------

信息收集在此不做过多缀述了，因前面已经有大佬在第一期的文章里相当做了大部分的信息收集工作说明了，在此本菜鸡就弱弱的做补充，关于一些 web 框架、CMS(整站系统) 和中间件的一些探测技巧。

Web 框架探测
--------

技巧 1. 上插件

![](https://mmbiz.qpic.cn/mmbiz_png/RpxgdDjibJqfwiakCNdwAHLvQnkoq4SOI2dD2fsiaFic3BlActa5unPhn18vSL4iaMWDQ3t7KeicKWVViadBpWSdMNVeg/640?wx_fmt=png)

![](https://mmbiz.qpic.cn/mmbiz_png/RpxgdDjibJqfwiakCNdwAHLvQnkoq4SOI2KicsOAWs4YUDNMThHVWpXyggZ1l4GPqFZgPtp8vroO0PIcslRfia1Q7A/640?wx_fmt=png)

此插件名为魔眼。

魔眼是魔工坊出自的一款基于最新前端技术的 Chrome 浏览器扩展应用。它提供了一键识别网站 CMS、框架、库、服务器、操作系统、统计、广告、开发语言版本等信息的强大功能，尤其是针对国内开发者进行了优化。绝对精品！

魔眼不仅能在互联网进行探测，内网环境下也是可以的探测到一部分有效的信息。

![](https://mmbiz.qpic.cn/mmbiz_png/RpxgdDjibJqfwiakCNdwAHLvQnkoq4SOI2be97EbcyRZzWp0hduL7X51GgBvicribPlBnVGV9cYUJtqD0MgkGbxgMQ/640?wx_fmt=png)

web 框架、cms、环境信息、版本等都探测出来了，![](https://mmbiz.qpic.cn/mmbiz_png/RpxgdDjibJqfwiakCNdwAHLvQnkoq4SOI2dfvckf8WwPTouuXIJRtQySpawfjNQ5hSdqggZKaMcIAUfxHHSRE3Fg/640?wx_fmt=png)

技巧 2 在如 url 里任意输入一个不存在的目录，就会曝出一些有关于其他的信息，如使用的框架及版本，还有一些物理路径等信息![](https://mmbiz.qpic.cn/mmbiz_png/RpxgdDjibJqfwiakCNdwAHLvQnkoq4SOI2o2KeTJ5QEh6wCg3ibLXiae0PKPoOTWIhx51Jiba9ibkiap4JW64CISfygmQ/640?wx_fmt=png)![](https://mmbiz.qpic.cn/mmbiz_png/RpxgdDjibJqfwiakCNdwAHLvQnkoq4SOI2lyfj7RHVRREkgNqLcWuTiclpibDJCdfwrDPN2UI3HpU0e4OdjnrWr6dw/640?wx_fmt=png)

![](https://mmbiz.qpic.cn/mmbiz_png/RpxgdDjibJqfwiakCNdwAHLvQnkoq4SOI2Q040ovE4sPTBibgeyXVBY9JQ9fgLK5Gp6iaqDhSduPUrfibgRZknyTwHg/640?wx_fmt=png)

CMS 探测
------

技巧 3 常见的 CMS 有：WordPress、Dedecms、Discuz、PhpWeb、PhpWind、Dvbbs、PhpCMS、ECShop、、SiteWeaver、AspCMS、帝国、Z-Blog 等。

CMS 指纹识别又有很多方法，比如说御剑指纹识别、Webrobot 工具、whatweb 工具、还有在线查询的网站等等。

CMS 在线指纹识别：   
http://whatweb.bugscaner.com/look/

![](https://mmbiz.qpic.cn/mmbiz_png/RpxgdDjibJqfwiakCNdwAHLvQnkoq4SOI2Ht8gRib77tzLrSIZKV4JqtZx2lXFKZeFgNqx7e7BVLqJgJkFh95Cicbg/640?wx_fmt=png)

中间件探测
-----

技巧 1 使用 nmap 进行端口探测，通过端口识别确认中间件

![](https://mmbiz.qpic.cn/mmbiz_png/RpxgdDjibJqfwiakCNdwAHLvQnkoq4SOI2RwXuxM3iagKJ5gE4D90umJ6Xt69MiaWbibOaVz9uMguiaibZs6JKmtr9IXQ/640?wx_fmt=png)

http 标头，特定目录如 weblogic 有 console 这个目录等，特定端口，网站链接后缀，尝试报错访问，robots.txt 等。

在加上之前有大佬的那些探测方法了解这些信息之后，我们就需要知道网站用的 web 服务器是什么类型的：Apache、Nginx、Tomcat 还是 IIS。  
知道了 web 服务器是哪种类型后，我们还要探测 web 服务器具体的版本。  
比如 Ngnix 版本 < 0.83 会有解析漏洞 ，IIS6.0 会有文件名解析漏洞、IIS7.0 会有畸形解析漏洞等。不同的 web 服务器版本，存在着不同漏洞。

2.1 web 网站常规功能测试
================

一、输入框
-----

1. 字符型输入框：

（1）字符型输入框：英文全角、英文半角、数字、空或者空格、特殊字符 <>@#￥%……&*？[]{}” 特别要注意单引号和 & 符号。在遇到禁止直接输入特殊字符时，使用 “粘贴、拷贝” 功能尝试输入。

（2）长度检查：最小长度、最大长度、最小长度 - 1、最大长度 + 1、输入超长字符比如把整个文章拷贝过去。

（3）多行文本框输入：允许回车换行、保存后再显示能够保存输入的格式、仅输入回车换行，检查能否正确保存（若能，检查保存结果，若不能，查看是否有正常提示）、

（4）信息重复性: 在一些需要命名, 且名字应该唯一的信息输入重复的名字或 ID, 看系统有没有处理, 是否报错, 重名包括是否区分大小写, 以及在输入内容的前后输入空格, 系统是否作出正确处理.

（5）安全性检查：输入脚本函数 (

)、**hello**）

2. 数值型输入框：

（1）边界值：最大值、最小值、最大值 + 1、最小值 - 1

（2）位数：最小位数、最大位数、最小位数 - 1 最大位数 + 1、输入超长值、输入整数

（3）异常值、特殊字符：输入空格或 "~!@#$%^&*()_+{}|[]\:"<>?;',./?;:'-= 等可能导致系统错误的字符。在遇到禁止直接输入特殊字符时，尝试使用粘贴拷贝查看是否能正常提交、word 中的特殊功能，通过剪贴板拷贝到输入框，分页符，分节符类似公式的上下标等、数值的特殊符号如∑，㏒，㏑，∏，+，- 等、输入负整数、负小数、分数、输入字母或汉字、小数（小数前 0 点舍去的情况，多个小数点的情况）、首位为 0 的数字如 01、02、科学计数法是否支持 1.0E2、全角数字与半角数字、数字与字母混合、16 进制，8 进制数值、货币型输入（允许小数点后面几位）、

（4）安全性检查：不能直接输入就 copy

二、搜索功能
------

若查询条件为输入框，则参考输入框对应类型的测试方法

1. 功能实现：

（1）如果支持模糊查询，搜索名称中任意一个字符是否能搜索到

（2）比较长的名称是否能查到

（3）输入系统中不存在的与之匹配的条件

（4）用户进行查询操作时，一般情况是不进行查询条件的清空，除非需求特殊说明。

2. 组合测试：

（1）不同查询条件之间来回选择，是否出现页面错误（单选框和多选框最容易出错）

（2）测试多个查询条件时，要注意查询条件的组合测试，可能不同组合的测试会报错。

三、添加、修改功能
---------

1、唯一性：

（1）字段唯一的，是否可以重复添加，添加后是否能修改为已存在的字段（字段包括区分大小写以及在输入的内容前后输入空格，保存后，数据是否真的插入到数据库中，注意保存后数据的正确性）

2、数据正确性：

（1）对编辑页的每个编辑项进行修改，点击保存，是否可以保存成功，检查想关联的数据是否得到更新。

（2）进行必填项检查（即是否给出提示以及提示后是否依然把数据存到数据库中；是否提示后出现页码错乱等）

（3）是否能够连续添加（针对特殊情况）

（4）在编辑的时候，注意编辑项的长度限制，有时在添加的时候有，在编辑的时候却没有（注意要添加和修改规则是否一致）

（5）对于有图片上传功能的编辑框，若不上传图片，查看编辑页面时是否显示有默认的图片，若上传图片，查看是否显示为上传图片

（6）修改后增加数据后，特别要注意查询页面的数据是否及时更新，特别是在首页时要注意数据的更新。

（7）提交数据时，连续多次点击，查看系统会不会连续增加几条相同的数据或报错。

（8）若结果列表中没有记录或者没选择某条记录，点击修改按钮，系统会抛异常。

四、删除功能
------

1、提示信息：

（1）不选择任何信息，直接点击删除按钮，是否有提示  
（2）删除某条信息时，应该有确认提示

2、数据实现：

（1）是否能连续删除多个产品

（2）当只有一条数据时，是否可以删除成功

（3）删除一条数据后，是否可以添加相同的数据

（4）如系统支持批量删除，注意删除的信息是否正确

（5）如有全选，注意是否把所有的数据删除

（6）删除数据时，要注意相应查询页面的数据是否及时更新

（7）如删除的数据与其他业务数据关联，要注意其关联性（如删除部门信息时，部门下游员工，则应该给出提示）

（8）如果结果列表中没有记录或没有选择任何一条记录，点击删除按钮系统会报错。

如：某一功能模块具有最基本的增删改查功能，则需要进行以下测试：

单项功能测试（增加、修改、查询、删除）  
增加——> 增加——> 增加 （连续增加测试）  
增加——> 删除  
增加——> 删除——> 增加 （新增加的内容与删除内容一致）  
增加——> 修改——> 删除  
修改——> 修改——> 修改 （连续修改测试）  
修改——> 增加（新增加的内容与修改前内容一致）  
修改——> 删除  
修改——> 删除——> 增加 （新增加的内容与删除内容一致）  
删除——> 删除——> 删除 （连续删除测试）

五、注册、登录模块
---------

1、注册功能：

（1）注册时，设置密码为特殊版本号，检查登录时是否会报错

（2）注册成功后，页面应该以登陆状态跳转到首页或指定页面

（3）在注册信息中删除已输入的信息，检查是否可以注册成功。

2、登陆功能：

（1）输入正确的用户名和正确的密码

（2）输入正确的用户名和错误的密码

（3）输入错误的用户名和正确的密码

（4）输入错误的用户名和错误的密码

（5）不输入用户名和密码

（6）只输入用户名，密码为空

（7）用户名为空，只输入密码

（8）输入正确的用户名和密码，但是不区分大小写

（9）用户名和密码包括特殊字符

（10）用户名和密码输入超长值

（11）已删除的用户名和密码

（12）登录时，当页面刷新或重新输入数据时，验证码是否更新

六、上传图片测试
--------

1、功能 实现：

（1）文件类型正确、大小合适

（2）文件类型正确，大小不合适

（3）文件类型错误，大小合适

（4）文件类型和大小都合适，上传一个正在使用中的图片

（5）文件类型大小都合适，手动输入存在的图片地址来上传

（6）文件类型和大小都合适，输入不存在的图片地址来上传

（7）文件类型和大小都合适，输入图片名称来上传

（8）不选择文件直接点击上传，查看是否给出提示

（9）连续多次选择不同的文件，查看是否上传最后一次选择的文件

七、查询结果列表
--------

1、功能实现：

（1）列表、列宽是否合理

（2）列表数据太宽有没有提供横向滚动

（3）列表的列名有没有与内容对应

（4）列表的每列的列名是否描述的清晰

（5）列表是否把不必要的列都显示出来

（6）点击某列进行排序，是否会报错

（7）双击或单击某列信息，是否会报错

八、直接 URL 链接检查
-------------

1、在 Web 系统中，在地址栏直接输入各个功能页面的 URL 地址，看系统如何处理，是否能够直接链接查看（匿名查看），是否有权限控制，是否直接执行，并返回相应结果页；

九、业务流程测试（主要功能测试）
----------------

业务流程，一般会涉及到多个模块的数据，所以在对业务流程测试时，首先要保证单个模块功能的正确性，其次就要对各个模块间传递的数据进行测试，这往往是容易出现问题的地方，测试时一定要设计不同的数据进行测试。

十、安全性测试
-------

（1）SQL 注入（比如登陆页面）

（2）XSS 跨网站脚本攻击：程序或数据库没有对一些特殊字符进行过滤或处理，导致用户所输入的一些破坏性的脚本语句能够直接写进数据库中，浏览器会直接执行这些脚本语句，破坏网站的正常显示，或网站用户的信息被盗, 构造脚本语句时，要保证脚本的完整性。  
　　

alert("abc")、、等

![](https://mmbiz.qpic.cn/mmbiz_png/RpxgdDjibJqfwiakCNdwAHLvQnkoq4SOI2nOzyhnOtzrUT0UkhFE9xPQ1COmgUGoviaWfvnc8Muddy1ZbVicfAuzWw/640?wx_fmt=png)

（4）Web 应用系统是否有超时的限制，也就是说，用户登陆后在一定时间内没有点击任何页面，是否需要重新登陆才能正常使用。

二、 工具选择和使用
----------

1：web 应用程序漏洞扫描工具

Nessus/goby/awvs

2：端口扫描

Nmap

3：sql 注入工具

  sqlmap

4: http 代理请求抓包工具

Burpsuite

三、漏洞验证

Msfconsole