> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/FY6N1Rqv2uhyC18E2gKykQ)

![](https://mmbiz.qpic.cn/mmbiz_png/XWPpvP3nWaibH2uDXYgT5faOIAIGPghRrAyljEx9tvDWDPUCxCic1F1IriazshQkD5siauia6GejluBjOOwtJdoUD8Q/640?wx_fmt=png)

三连一下，一起学安全

****文章来源｜MS08067 WEB 攻防知识星球****

> 本文作者：**M-101**（Ms08067 实验室追洞小组成员）            

**漏洞复现分析  认准追洞小组  
**

![](https://mmbiz.qpic.cn/mmbiz_png/XWPpvP3nWa9Y7Ac6gb6JZVymJwS3gu8cniaUZzJeYAibE3v2VnNlhyC6fSTgtW94Pz51p0TSUl3AtZw0L1bDaAKw/640?wx_fmt=png)  

**漏洞名称**

Windows 任意代码执行漏洞

**漏洞编号**

CVE-2020-16898

**漏洞描述**

成功利用该漏洞的攻击者可以在目标机器（主机或服务器）上执行任意代码。

**漏洞版本**

Microsoft Windows 10 1709 

Microsoft Windows 10 1803 

Microsoft Windows 10 1809 

Microsoft Windows 10 1903 

Microsoft Windows 10 1909 

Microsoft Windows 10 2004 

Microsoft Windows Server 2019

Microsoft Windows Server, version 1903

Microsoft Windows Server, version 1909

Microsoft Windows Server, version 2004

**漏洞分析**

当 Windows TCP / IP 堆栈不正确地处理使用选项类型 25（递归 DNS 服务器选项）且长度字段值为偶数的 ICMPv6 路由器广告数据包时，存在一个远程执行代码漏洞。在此选项中，长度以 8 个字节为增量进行计数，因此长度为 3 的 RDN 选项的总长度应为 24 个字节。该选项本身包含五个字段：IPv6 递归 DNS 服务器的类型，长度，保留，生存时间和地址。前四个字段始终总共为 8 个字节，但最后一个字段可以包含可变数量的 IPv6 地址，每个 IPv6 地址均为 16 个字节。按照 RFC 8106，长度字段应始终为至少 3 的奇数值，当提供一个偶数长度值时，Windows TCP / IP 堆栈错误地将网络缓冲区的前进量减少了 8 个字节。这是因为堆栈在内部以 16 字节为增量进行计数，因此无法解决使用非 RFC 兼容长度值的情况。这种不匹配导致堆栈将当前选项的最后 8 个字节解释为第二个选项的开始，最终导致缓冲区溢出和潜在的 RCE。

**实验环境及准备**

Win10、Kali

**复现步骤**

开启 ipv6

![](https://mmbiz.qpic.cn/mmbiz_png/XWPpvP3nWaibH2uDXYgT5faOIAIGPghRrEucPwNlkQ6mtQib855bzXkMh6R6DE5j0Uc46ib7fxRk7iaY8HiaCNxoRQg/640?wx_fmt=png)

![](https://mmbiz.qpic.cn/mmbiz_jpg/XWPpvP3nWaibH2uDXYgT5faOIAIGPghRrd55T4Wg2UibuklPalUQp3u1WTbf1WmgLkkoIuIm5kMQCHiaKmiaGPUl9Q/640?wx_fmt=jpeg)

查看版本信息

![](https://mmbiz.qpic.cn/mmbiz_png/XWPpvP3nWaibH2uDXYgT5faOIAIGPghRrEucPwNlkQ6mtQib855bzXkMh6R6DE5j0Uc46ib7fxRk7iaY8HiaCNxoRQg/640?wx_fmt=png)

![](https://mmbiz.qpic.cn/mmbiz_jpg/XWPpvP3nWaibH2uDXYgT5faOIAIGPghRrT0IGCwU4GGAj7zJFicicMOxQxicGjXvC06xHB7MmcW9XDpV1rIuzJTjAg/640?wx_fmt=jpeg)

查看 IP

![](https://mmbiz.qpic.cn/mmbiz_png/XWPpvP3nWaibH2uDXYgT5faOIAIGPghRrEucPwNlkQ6mtQib855bzXkMh6R6DE5j0Uc46ib7fxRk7iaY8HiaCNxoRQg/640?wx_fmt=png)

![](https://mmbiz.qpic.cn/mmbiz_png/XWPpvP3nWaibH2uDXYgT5faOIAIGPghRrufsqI8Ecicn9qDLsBjjZXfMrmhq7zWkyd7Sicm5Hga0kChE1ojEpA92Q/640?wx_fmt=png)

执行 poc

![](https://mmbiz.qpic.cn/mmbiz_png/XWPpvP3nWaibH2uDXYgT5faOIAIGPghRrEucPwNlkQ6mtQib855bzXkMh6R6DE5j0Uc46ib7fxRk7iaY8HiaCNxoRQg/640?wx_fmt=png)

![](https://mmbiz.qpic.cn/mmbiz_png/XWPpvP3nWaibH2uDXYgT5faOIAIGPghRrfScXhJjribUq6rLgNeFJPbiawXfm9IIjPEy44ziaVpcIYGuAnficbhHkhQ/640?wx_fmt=png)

![](https://mmbiz.qpic.cn/mmbiz_png/XWPpvP3nWaibH2uDXYgT5faOIAIGPghRrEucPwNlkQ6mtQib855bzXkMh6R6DE5j0Uc46ib7fxRk7iaY8HiaCNxoRQg/640?wx_fmt=png)

![](https://mmbiz.qpic.cn/mmbiz_jpg/XWPpvP3nWaibH2uDXYgT5faOIAIGPghRrtXYIAiag17RhsI6fo21IofCTIpGvB2uZrtY9oJcicOn0CE0xasdKCGAA/640?wx_fmt=jpeg)  

公众号  

**扫描下方二维码加入星球学习**

**加入后会邀请你进入内部微信群，内部微信群永久有效！**

![](https://mmbiz.qpic.cn/mmbiz_png/XWPpvP3nWa9Y7Ac6gb6JZVymJwS3gu8cniaUZzJeYAibE3v2VnNlhyC6fSTgtW94Pz51p0TSUl3AtZw0L1bDaAKw/640?wx_fmt=png) ![](https://mmbiz.qpic.cn/mmbiz_png/XWPpvP3nWa9Y7Ac6gb6JZVymJwS3gu8cT2rJYbRzsO9Q3J9rSltBVzts0O7USfFR8iaFOBwKdibX3hZiadoLRJIibA/640?wx_fmt=png)

![](https://mmbiz.qpic.cn/mmbiz_png/XWPpvP3nWaicBVC2S4ujJibsVHZ8Us607qBMpNj25fCmz9hP5T1yA6cjibXXCOibibSwQmeIebKa74v6MXUgNNuia7Uw/640?wx_fmt=png)![](https://mmbiz.qpic.cn/mmbiz_png/XWPpvP3nWa9Y7Ac6gb6JZVymJwS3gu8cRey7icGjpsvppvqqhcYo6RXAqJcUwZy3EfeNOkMRS37m0r44MWYIYmg/640?wx_fmt=png)

![](https://mmbiz.qpic.cn/mmbiz_jpg/XWPpvP3nWaicjovru6mibAFRpVqK7ApHAwiaEGVqXtvB1YQahibp6eTIiaiap2SZPer1QXsKbNUNbnRbiaR4djJibmXAfQ/640?wx_fmt=jpeg) ![](https://mmbiz.qpic.cn/mmbiz_png/XWPpvP3nWaicJ39cBtzvcja8GibNMw6y6Amq7es7u8A8UcVds7Mpib8Tzu753K7IZ1WdZ66fDianO2evbG0lEAlJkg/640?wx_fmt=png)  

**目前 36000 + 人已关注加入我们  
**![](https://mmbiz.qpic.cn/mmbiz_gif/XWPpvP3nWa9FwrfJTzPRIyROZ2xwWyk6xuUY59uvYPCLokCc6iarKrkOWlEibeRI9DpFmlyNqA2OEuQhyaeYXzrw/640?wx_fmt=gif)