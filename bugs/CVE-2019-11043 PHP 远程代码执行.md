> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/c2TkwX150gcLzitfOXxwIw)

![](https://mmbiz.qpic.cn/mmbiz_gif/3xxicXNlTXLicwgPqvK8QgwnCr09iaSllrsXJLMkThiaHibEntZKkJiaicEd4ibWQxyn3gtAWbyGqtHVb0qqsHFC9jW3oQ/640?wx_fmt=gif)  

**CVE-2019-11043 远程代码执行漏洞复现漏洞名称：**

php fastcgi 远程命令执行漏洞

**漏洞类型：**远程代码执行漏洞

**漏洞危害：**高危

**漏洞来源：**

https://www.nginx.com/blog/php-fpm-cve-2019-11043-vulnerability-nginx/

**公布时间:**2019-10-28

**涉及应用版本：**

<7.1.33 的 PHP 版本 7.1.x

<7.2.24 的 7.2.x

<7.3.11 的 7.3.x 容易受到攻击

**修复版本：**

php: 7.1.33 7.2.24 7.3.11 应用语言：php 漏洞简介：该漏洞可以通过构造 url 请求，实现远程代码执行

  
**漏洞影响：**

攻击者可以通过此漏洞远程执行恶意代码来入侵服务器

  
**漏洞利用条件**

*   已安装易受攻击的 PHP 版本
    
*   底层服务器是 NGINX
    
*   php-fpm 已启用  
    

**漏洞分析：**

漏洞主要存在于 fpm——main.c 的代码，里面的 localhost~[^/]\.php(/|$) 代码中，分了两次匹配 url，导致可以构造 url 请求执行代码 

 ![](https://mmbiz.qpic.cn/mmbiz_png/3xxicXNlTXLibuTnYgAYcNpgarKEWmOk6bXibZRmtEePzEJbA1PIQRLEiawLIricSpiaibSyPRdP6Fq6ItyJSpwH2zmHA/640?wx_fmt=png) 

**漏洞修复：**

更新 php 版本 >=7.1.33 7.2.24 7.3.11

  
**测试操作系统环境：**

kali 测试环境：vulhub/php/CVE-2019-11043

 ![](https://mmbiz.qpic.cn/mmbiz_png/3xxicXNlTXLibuTnYgAYcNpgarKEWmOk6boqHylNvVNMhhgwJyTD1pbt2sZepxmO2JSul99rhIrSQVdnLkHPtOUA/640?wx_fmt=png) 

  
访问 kali 主机 IP 的 8080 端口，漏洞环境已经搭建好

 ![](https://mmbiz.qpic.cn/mmbiz_png/3xxicXNlTXLibuTnYgAYcNpgarKEWmOk6bjXLrT58SQAeNID4s36T5k6mxkAt8kcI2kNNY8nwrb6oCLqGkgeCfJw/640?wx_fmt=png)   
在 github 上下载 exp，由于是 go 语言，需先下载 go 语言包  

![](https://mmbiz.qpic.cn/mmbiz_png/3xxicXNlTXLibuTnYgAYcNpgarKEWmOk6bwSpg8JzibfVxmSuKHjyzWV6GChITaxicpdxynTCaQvVa8UAM7BKW46qQ/640?wx_fmt=png)

搭建 go 环境，可以百度一下啊

 ![](https://mmbiz.qpic.cn/mmbiz_png/3xxicXNlTXLibuTnYgAYcNpgarKEWmOk6bWVrdfVlicb14nD1TGmKcARARbuIaoFr2pbeu7311dtYibF3gn3EiawKOw/640?wx_fmt=png) 

  
执行上面命令后，目录下就会生成 phuip-fpizdam 文件，然后执行攻击命令

./phuip-fpizdam http://192.168.123.49:8080/index.php

 ![](https://mmbiz.qpic.cn/mmbiz_png/3xxicXNlTXLibuTnYgAYcNpgarKEWmOk6bqJ0Dmb7VEszDIiaq4ibHtZNVAYAYbeSGBx3VblxbUjKbiaWZJYTj9aJww/640?wx_fmt=png) 

攻击成功

 ![](https://mmbiz.qpic.cn/mmbiz_png/3xxicXNlTXLibuTnYgAYcNpgarKEWmOk6baJgrrBCmVy2s7Yick9dGb8kygeC8d1UTAdKB9eqzaEwBm2JpOPgXCYQ/640?wx_fmt=png) 

在网页上执行

 ![](https://mmbiz.qpic.cn/mmbiz_png/3xxicXNlTXLibuTnYgAYcNpgarKEWmOk6bcLWYsxhjvlCHd5xEicEpgUTfLxFoZ3ROafRylm6yY0JxQ1mAnhicXqsg/640?wx_fmt=png) 

![](https://mmbiz.qpic.cn/mmbiz_jpg/3xxicXNlTXLicjiasf4mjVyxw4RbQt9odm9nxs9434icI9TG8AXHjS3Btc6nTWgSPGkvvXMb7jzFUTbWP7TKu6EJ6g/640?wx_fmt=jpeg)

推荐文章 ++++

![](https://mmbiz.qpic.cn/mmbiz_jpg/US10Gcd0tQFGib3mCxJr4oMx1yp1ExzTETemWvK6Zkd7tVl23CVBppz63sRECqYNkQsonScb65VaG9yU2YJibxNA/640?wx_fmt=jpeg)

*[Apache Shiro 1.2.4 反序列化漏洞复现（CVE-2016-4437）](http://mp.weixin.qq.com/s?__biz=MzAxMjE3ODU3MQ==&mid=2650494540&idx=4&sn=7a0a2f2cb5508dd7582d7d80602b96ad&chksm=83ba33a8b4cdbabe575476e581209631877526b63dd96f7cb15881d12c50a2b6d0daae4ff78f&scene=21#wechat_redirect)  

*[Webmin 远程命令执行（CVE-2019-15107）漏洞利用](http://mp.weixin.qq.com/s?__biz=MzAxMjE3ODU3MQ==&mid=2650491765&idx=4&sn=b26aaffa37cce299469b16cde933e216&chksm=83ba2e91b4cda7879bb7577294dbe08b853d85ee6879eb529a0e3a58ef04f8f424d3f4cd3a1b&scene=21#wechat_redirect)

*[CVE-2018-18852 简单利用](http://mp.weixin.qq.com/s?__biz=MzAxMjE3ODU3MQ==&mid=2650488972&idx=4&sn=328001a1e082afa7e765396dc8a394f0&chksm=83ba2568b4cdac7ee896951d6e983e2b0741b617b63a02e7207dea0ae8e1ab726baa550a5bde&scene=21#wechat_redirect)

![](https://mmbiz.qpic.cn/mmbiz_png/3xxicXNlTXLib0FWIDRa9Kwh52ibXkf9AAkntMYBpLvaibEiaVibzNO1jiaVV7eSibPuMU3mZfCK8fWz6LicAAzHOM8bZUw/640?wx_fmt=jpeg)

![](https://mmbiz.qpic.cn/mmbiz_gif/NZycfjXibQzlug4f7dWSUNbmSAia9VeEY0umcbm5fPmqdHj2d12xlsic4wefHeHYJsxjlaMSJKHAJxHnr1S24t5DQ/640?wx_fmt=gif)