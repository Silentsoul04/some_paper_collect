\> 本文由 \[简悦 SimpRead\](http://ksria.com/simpread/) 转码， 原文地址 \[mp.weixin.qq.com\](https://mp.weixin.qq.com/s/UtOZlJu3aLnWt1A6CwOk3g)

  

漏洞点发掘

首先通过 CVE 官方搜索列表，搜索相关 CVE 细节，如下图所示：

![](https://mmbiz.qpic.cn/mmbiz_png/RXib24CCXQ08WCnU0ibLq3FeID6ibNJnxjE4OFw9aB59ZfDJiaMl6ylFNucaeg0tmmOG6a9aO9ue7vCvNzZHWs4pgw/640?wx_fmt=png)

找到官方 security 修复通告，根据官方通告，找到对应 Patches，如下图所示：

![](https://mmbiz.qpic.cn/mmbiz_png/RXib24CCXQ08WCnU0ibLq3FeID6ibNJnxjEdPuS9qPtnVD3dt0qxJotB2ZsY9vfElDHzDHF8ia4cgZicek1VqGdq3LA/640?wx_fmt=png)

根据 Patches 与 CVE 描述，找到对应漏洞点，如下图所示：

![](https://mmbiz.qpic.cn/mmbiz_png/RXib24CCXQ08WCnU0ibLq3FeID6ibNJnxjEYt93vmiaYyicSAicVffypKyHzjicPJDcIibuqWv0nAY7gD8QVpXQjhmIzibA/640?wx_fmt=png)

  

分析漏洞调用

**分析源码框架**

PhpMyadmin 拥有 libraries、sql、vendor 和 templates 等文件夹，libraries 文件夹下大多为 controller 模块，采用空间命名的方式，调用方法与类

![](https://mmbiz.qpic.cn/mmbiz_png/RXib24CCXQ08WCnU0ibLq3FeID6ibNJnxjEhxWyDelcQic21ibu9d8XVN7AuAPtnn99Cib4wFqiadn5Y3zJ7UGGBXfrYA/640?wx_fmt=png)

已知漏洞点在 controller 模块中，那么需要找到对应的调用 controller 的位置，可以找到三个文件调用了漏洞模块，如下图所示：

![](https://mmbiz.qpic.cn/mmbiz_png/RXib24CCXQ08WCnU0ibLq3FeID6ibNJnxjE0VibSSBrgeEdCLZcn5mAMwugJ1dSNmG8jRQJZ1gSAWZzGdu8x58t4JQ/640?wx_fmt=png)

观察图中文件，发现共同调用了其中的一个方法 indexAction，对应分析 indexAction 方法，indexAction 方法中对 searchType 进行了判断，对应三个文件为 replace、zoom 和 Normal。分析补丁中的修改方法，首先分析 zoomSubmitAction 方法

![](https://mmbiz.qpic.cn/mmbiz_png/RXib24CCXQ08WCnU0ibLq3FeID6ibNJnxjEukY5Jicfctghxp0MNiciaFKGUUMiafRJ4tB6K3v7zMyXiagYibKr3B9XG8xA/640?wx_fmt=png)

可以看到在 tmpData 赋值后无查询语句，分析 getDataRowAction 方法

![](https://mmbiz.qpic.cn/mmbiz_png/RXib24CCXQ08WCnU0ibLq3FeID6ibNJnxjET7yugRgpSf84YCUzhFCAfhTf1Agu1lw3j04ItMtuajLM3SkpncKJyQ/640?wx_fmt=png)

可以看到方法中运行了 sql 语句，并且对 where\_clause 未做任何防护措施，结合 patches，断定漏洞点触发位置。

直接访问 tbl\_zoom\_select.php?db=test&table=test，携带恶意数据即可复现漏洞。在漏洞复现时要注意选定 db 和 table，在 tbl\_zoom\_select.php 在 tbl\_common.inc.php 中会检测 db 与 table 是否存在，不存在则 exit。

end

  

![](https://mmbiz.qpic.cn/mmbiz_png/RXib24CCXQ08WCnU0ibLq3FeID6ibNJnxjERFVVQlKVqfG5I0HNYnXwXicoN7P27ETN8m5jB4XvjQIRKUBl7cQcNCA/640?wx_fmt=png)